@model IEnumerable<myWall.ViewModel.ContentViewModel>

@{
    ViewBag.Title = "Index";
}

<head>
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
</head>


<h2>Index</h2>








<p>
    @Html.ActionLink("Create New Page Content", "Create", null, new { @class = "btn btn-primary" })
</p>

<br />
<table class="table" style="width: 1200px;">
    

    @foreach (var item in Model)
    {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.Title)
            </td>
            <td style="width: 500px;">
                @Html.Raw(item.Contents)
            </td>
            <td>
                <img src="/Home/RetrieveImage/@item.Id" alt="" height=300 width=400 />
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Description)
            </td>
        </tr>

        @Html.ActionLink("Delete", "Delete", new { id = item.Id })
    }


</table>


<div>
    <input type='file' id="files" multiple="multiple" />
    <input type="button" id="upload" value="Upload" />
</div>

<script>
    $body = $("body");
    $(document).on({
        ajaxStart: function () { $body.addClass("loading"); },
        ajaxStop: function () { $body.removeClass("loading"); }
    });

    $(document).ready(function () {
        $("#upload").click(function () {
            var data = new FormData();

            //Add the Multiple selected files into the data object
            var files = $("#files").get(0).files;
            for (i = 0; i < files.length; i++) {
                data.append("files" + i, files[i]);
            }

            //Post the data (files) to the server
            if (files.length > 0) {
                $.ajax({
                    type: 'POST',
                    url: "@Url.Action("Upload")",
                    data: data,
                    contentType: false,
                    processData: false,
                    success: function (data) {
                        alert("Successfully Uploaded!");
                       // $('#files').reset()
                        window.location.reload(false);


                    },
                    error: function () {
                        alert("An error occurred!");
                    },
                });
            }
        });
    });
</script>






